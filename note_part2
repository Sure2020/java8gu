8 Gu Part2
51. 如何存ip地址，分为ipv4/6。   都有两种，用字符串或者整数。字符串比较占空间，而且比较大小也比整形慢。
字符串，没啥可说的。
整形，mysql中ipv4用binary(4)，也就是4字节，32 位存，先各段转为二进制，再去掉点号，最后二进制转为整型。
ipv6用binary(16)表示，也就是16*8=128字节。

52. rpc调用，客户端超时，服务端没超时，怎么回事。网络延迟或丢包；   客户端超时时间比服务端短

53. 为啥不建议用mq延迟队列实现订单到期关闭。
每个消息都要一个延迟消息，即使这个订单会立即关闭。仍然会创建延迟消息，消耗资源。   mq本身不支持延迟消息，即使支持，也有限制比如限制最长延迟时间。   消息有延迟。

54. 为什么不要在事务中做外部调用。因为外部调用不可控，如果外部调用性能差，回复延迟高，甚至报错等，会拖慢整个事务的性能，而且出错了不能回退。
建议是将事务和外部调用分离。   如果外部调用必须和数据库操作紧密集成，那可以使用补偿事务，用来处理外部调用失败的情况，用来撤销已经执行的外部调用。  

55. 如何做平滑的数据迁移。写旧读旧---双写读旧，可以借助flink\canal等数据同步工具实现，也可以自己写代码实现，先写旧库，成功后再写新库。---增量数据核对---存量数据迁移---存量数据核对---双写读新（灰度切流）---全量数据核对---写新读新（灰度切流）。
